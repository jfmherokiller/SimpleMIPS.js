/*! SimpleMIPS.js
	----------------------------------------------
	Visualize basic MIPS architecture in a browser
	- Including a mini assembler
	- 5 stage pipeline with forwarding and hazard detection
	Note: This is unfinished work
	Author: Mianzhi Wang
*/
var SimpleMIPS=(function(c){var e={};
if(!Uint32Array||!Array.prototype.indexOf){console.log("unsupported browser");e.unsupported=true;return;}function i(q,p,o){if(o){for(var n in o){p[n]=o[n];
}for(var m in p){q[m]=p[m];}}else{for(var l in p){q[l]=p[l];}return q;}}function d(m,l){if(typeof(m)=="function"){i(m.prototype,l);}else{i(m,l);}}function g(n,m){var l=n.prototype.constructor;
if(typeof(m.constructor)=="function"){n.prototype=new m();n.prototype._super=m;n.prototype.constructor=l;}else{n.prototype=m;n.prototype._super=m;n.prototype.constructor=l;
}}function k(r,p){var s,q,o=r.length,t=p.length,l=[];for(s=0;s<t;s++){for(q=0;q<o;q++){if(r[s]==p[q]){l.push(r[s]);}}}return l;}function f(p,o,l){var q=l-p.length;
if(q<=0){return p;}for(var m=0;m<q;m++){p=o+p;}return p;}var h=(function(){function l(){this._bus={};}d(l,{register:function(m,n){if(!this._bus[m]){this._bus[m]=[n];
}else{this._bus[m].push(n);}},remove:function(m,n){var o=this._bus[m];if(o){o.splice(o.indexOf(n),1);}},post:function(p){var m=Array.prototype.slice.call(arguments,1),q=this._bus[p];
if(q){for(var o=0,r=q.length;o<r;o++){q[o].apply(null,m);}}}});return l;})();e.EventBus=h;var j=(function(){var l=65536;var n=l-1;var m=16;function o(){this.chunks=[];
this.latencyCtr=0;this.latency=1;this.busy=false;}d(o,{getChunk:function(q){var p=this.chunks[q>>>m];if(!p){p=new Uint8Array(l);this.chunks[q>>>m]=p;}this.busy=true;
return p;},getWord:function(r){var p=this.getChunk(r);r&=n;var q=(p[r]<<24)|(p[r+1]<<16)|(p[r+2]<<8)|(p[r+3]);return(q<0?4294967296+q:q);},getHalfword:function(q){var p=this.getChunk(q);
q&=n;return((p[q]<<8)|(p[q+1]));},getByte:function(p){return(this.getChunk(p)[(p&n)]);},setWord:function(r,q){var p=this.getChunk(r);r&=n;p[r]=(q&4278190080)>>>24;
p[r+1]=(q&16711680)>>>16;p[r+2]=(q&65280)>>>8;p[r+3]=(q&255);},setHalfword:function(r,q){var p=this.getChunk(r);r&=n;q&=65535;p[r]=(q&65280)>>>8;p[r+1]=(q&255);
},setByte:function(q,p){this.getChunk(q)[q&n]=(p&255);},step:function(){if(this.busy){this.latencyCtr++;if(this.latencyCtr>=this.latency){this.latencyCtr=0;
this.busy=false;}}},dump:function(v,t,q){var u=t*q,r,s,p="";for(r=0;r<u;r++){s=v+(r<<1);if(r%q==0){p+="0x"+f(s.toString(16),"0",8)+" :";}p+=" "+f(this.getByte(s).toString(16),"0",2)+f(this.getByte(s+1).toString(16),"0",2);
if(r%q==(q-1)){p+="\n";}}return p;},dumpToBuffer:function(u,s,p){var r=u,t=r+s,q=0;for(;r<t;r++,q++){p[q]=this.getByte(r);}},importAsm:function(t){var r,q,u,p,s;
p=t.dataStart;s=p+t.dataSize;for(r=p,q=0;r<s;r+=4,q++){this.setWord(r,t.dataMem[q]);}p=t.textStart;s=p+t.textSize;for(r=p,q=0;r<s;r+=4,q++){this.setWord(r,t.textMem[q]);
}}});return o;})();e.Memory=j;var a=(function(){var q={};var y={lb:["1000 00ss ssst tttt iiii iiii iiii iiii","RC","S"],lbu:["1001 00ss ssst tttt iiii iiii iiii iiii","RC","S"],lh:["1000 01ss ssst tttt iiii iiii iiii iiii","RC","S"],lhu:["1001 01ss ssst tttt iiii iiii iiii iiii","RC","S"],lui:["0011 1100 000t tttt iiii iiii iiii iiii","RI","U"],lw:["1000 11ss ssst tttt iiii iiii iiii iiii","RC","S"],sb:["1010 00ss ssst tttt iiii iiii iiii iiii","RC","S"],sh:["1010 01ss ssst tttt iiii iiii iiii iiii","RC","S"],sw:["1010 11ss ssst tttt iiii iiii iiii iiii","RC","S"],addi:["0010 00ss ssst tttt iiii iiii iiii iiii","RRI","S"],addiu:["0010 01ss ssst tttt iiii iiii iiii iiii","RRI","U"],add:["0000 00ss ssst tttt dddd d000 0010 0000","RRR","N"],addu:["0000 00ss ssst tttt dddd d000 0010 0001","RRR","N"],sub:["0000 00ss ssst tttt dddd d000 0010 0010","RRR","N"],subu:["0000 00ss ssst tttt dddd d000 0010 0011","RRR","N"],slt:["0000 00ss ssst tttt dddd d000 0010 1010","RRR","N"],slti:["0010 10ss ssst tttt iiii iiii iiii iiii","RRI","S"],sltu:["0000 00ss ssst tttt dddd d000 0010 1011","RRR","N"],sltiu:["0010 11ss ssst tttt iiii iiii iiii iiii","RRI","U"],and:["0000 00ss ssst tttt dddd d000 0010 0100","RRR","N"],andi:["0011 00ss ssst tttt iiii iiii iiii iiii","RRI","U"],or:["0000 00ss ssst tttt dddd d000 0010 0101","RRR","N"],ori:["0011 01ss ssst tttt iiii iiii iiii iiii","RRI","U"],xor:["0000 00ss ssst tttt dddd d000 0010 0110","RRR","N"],xori:["0011 10ss ssst tttt iiii iiii iiii iiii","RRI","U"],nor:["0000 00ss ssst tttt dddd d000 0010 0111","RRR","N"],sll:["0000 0000 000t tttt dddd daaa aa00 0000","RRA","N"],sllv:["0000 00ss ssst tttt dddd d000 0000 0100","RRR","N"],srl:["0000 0000 000t tttt dddd daaa aa00 0010","RRA","N"],sra:["0000 0000 000t tttt dddd daaa aa00 0011","RRA","N"],srlv:["0000 00ss ssst tttt dddd d000 0000 0110","RRR","N"],srav:["0000 00ss ssst tttt dddd d000 0000 0111","RRR","N"],j:["0000 10ii iiii iiii iiii iiii iiii iiii","I","U"],jr:["0000 00ss sss0 0000 0000 0000 0000 1000","R","N"],beq:["0001 00ss ssst tttt iiii iiii iiii iiii","RRI","S"],bne:["0001 01ss ssst tttt iiii iiii iiii iiii","RRI","S"],blez:["0001 10ss sss0 0000 iiii iiii iiii iiii","RI","S"],bgtz:["0001 11ss sss0 0000 iiii iiii iiii iiii","RI","S"],bltz:["0000 01ss sss0 0000 iiii iiii iiii iiii","RI","S"],bgez:["0000 01ss sss0 0001 iiii iiii iiii iiii","RI","S"],nop:["0000 0000 0000 0000 0000 0000 0000 0000","N","N"],"break":["0000 00cc cccc cccc cccc cccc cc00 1101","N","N"],print:["1111 11ss sss0 0000 0000 0000 0000 0000","R","N"],printm:["1111 11ss sss0 0000 0000 0000 0000 0001","R","N"],prints:["1111 11ss sss0 0000 0000 0000 0000 0010","R","N"]};
(function(){var D,N,S,L,C,O=[],R={RRR:[],RRI:[],RRA:[],RI:[],RC:[],R:[],I:[],N:[]},P=[],K=[],B=[],I=[];for(var E in y){D=y[E];if(D[0]&&D[0].length>0){R[D[1]].push(E);
O.push(E);if(E.charAt(0)=="b"){P.push(E);}if(D[0].indexOf("a")>0){K.push(E);}if(D[2]=="U"){B.push(E);}if(D[2]=="S"){I.push(E);}}}var M={},F,H,Q,T,G,J;for(var E in y){F="";
D=y[E][0].replace(/c/g,"0").replace(/a/g,"i").replace(/-/g,"0").replace(/ /g,"");H=parseInt(D.slice(0,6),2);F+="var base = "+(H<<26)+";\n";if(D.indexOf("s")>0){F+="base |= (info.rs << 21);\n";
}if(D.indexOf("d")>0){F+="base |= (info.rd << 11);\n";}if(D.indexOf("t")>0){F+="base |= (info.rt << 16);\n";}T=D.indexOf("i");G=D.lastIndexOf("i");J=G-T;
if(J>0){if(I.indexOf(E)>=0){F+="base |= (((info.imm<0)?"+(1<<(J+1))+"+info.imm:info.imm) << "+(31-G)+");\n";}else{F+="base |= (info.imm << "+(31-G)+");\n";
}}if(G<26){Q=parseInt(D.slice(26,32),2);F+="base |= "+(Q)+";\n";}F+="if (base < 0) base = 4294967296 + base;\n";F+="return base;";M[E]=new Function("info",F);
}q.INST_UNSIGNED=B;q.INST_IMM_SHIFT=K;q.INST_REL_PC=P;q.INST_CAT=R;q.INST_ALL=O;q.translators=M;})();var r={FUNCTIONAL:0,ACCURATE:1};q.SIM_MODE=r;var t={INVALID_INST:1,INT_OVERFLOW:2,PC_ALIGN:4,DATA_ALIGN:8,BRANCH_IN_DELAY_SLOT:16,BREAK:32,PC_LIMIT:64};
var A=268435456;q.EXCEPTION_CODE=t;var s={PC:1,IF:2,ID:4,EX:8,MA:16,WB:32},x={PC:~s.PC,IF:~s.IF,ID:~s.ID,EX:~s.EX,MA:~s.MA,WB:~s.WB};q.STALL_FLAGS=s;function l(C,D,B){this.eventBus=new h();
this.mode=D;this.mem=C;this.pc=0;this.cycle=0;this.registerFile=new Uint32Array(32);this.callbacks=B||{};if(D==r.FUNCTIONAL){this.step=z;this.reset=m;}else{this._initPipeline=v;
this.reset=u;this.step=o;}this.reset();}d(l,{dumpRegisterFile:function(B){if(!B){var D="";for(var C=0;C<32;C++){D+="r"+C+"\t: 0x"+f(this.registerFile[C].toString(16),"0",8)+"\n";
}return D;}else{for(var C=0;C<32;C++){B[C]=this.registerFile[C];}}}});function m(){this.cycle=0;this.pc=262144;this.branchTarget=c;this.registerFile[28]=268468224;
this.registerFile[29]=2147483644;}function z(P){var F=this.mem,J=this.registerFile,B=F.getWord(this.pc);J[0]=0;var R=0,C=false,L=this.pc+4,H=0,I=false,O=(B&4227858432)>>>26,D=B&63,G=(B&65011712)>>>21,E=(B&2031616)>>>16,N=(B&63488)>>>11,T=(B&1984)>>>6,Q=B&65535,K=(Q&32768)?(Q|4294901760):Q;
this.cycle++;switch(O){case 0:switch(D){case 0:J[N]=J[E]<<T;break;case 2:J[N]=J[E]>>>T;break;case 3:J[N]=J[E]>>T;break;case 4:J[N]=J[E]<<(J[G]&31);break;
case 6:J[N]=J[E]>>>(J[G]&31);break;case 7:J[N]=J[E]>>(J[G]&31);break;case 8:L=J[G];C=true;break;case 13:H|=t.BREAK;break;case 32:R=(J[G]|0)+(J[E]|0);if(R>2147483647||R<-2147483648){H|=t.INT_OVERFLOW;
}J[N]=R;break;case 33:J[N]=J[G]+J[E];break;case 34:R=(J[G]|0)-(J[E]|0);if(R>2147483647||R<-2147483648){H|=t.INT_OVERFLOW;}J[N]=R;break;case 35:J[N]=J[G]-J[E];
break;case 36:J[N]=J[G]&J[E];break;case 37:J[N]=J[G]|J[E];break;case 38:J[N]=J[G]^J[E];break;case 39:J[N]=~(J[G]|J[E]);break;case 42:J[N]=(J[G]|0)<(J[E]|0);
break;case 43:J[N]=(J[G]<J[E]);break;default:H|=INVALID_INST;}break;case 1:switch(E){case 0:if(J[G]|0<0){L=this.pc+(K<<2);C=true;}break;case 1:if(J[G]|0>=0){L=this.pc+(K<<2);
C=true;}break;default:H|=INVALID_INST;}break;case 2:R=this.pc;R=(R&4026531840)|((B&67108863)<<2);if(R<0){R=R+4294967296;}L=R;C=true;break;case 4:if(J[G]==J[E]){L=this.pc+(K<<2);
C=true;}break;case 5:if(J[G]!=J[E]){L=this.pc+(K<<2);C=true;}break;case 6:if(J[G]|0<=0){L=this.pc+(K<<2);C=true;}break;case 7:if((J[G]|0)>0){L=this.pc+(K<<2);
C=true;}break;case 8:R=(J[G]|0)+K;if(R>2147483647||R<-2147483648){H|=t.INT_OVERFLOW;}J[E]=R;break;case 9:if(Q&32768){J[E]=J[G]+Q+4294901760;}else{J[E]=J[G]+Q;
}break;case 10:J[E]=((J[G]|0)<K);break;case 11:R=Q&32767;if(Q&32768){J[E]=(J[G]<(R+4294901760));}else{J[E]=(J[G]<R);}break;case 12:J[E]=J[G]&Q;break;case 13:J[E]=J[G]|Q;
break;case 14:J[E]=J[G]^Q;break;case 15:J[E]=Q<<16;break;case 32:R=F.getByte(J[G]+K);if(R<128){J[E]=R;}else{J[E]=R|4294967040;}break;case 33:R=J[G]+K;if(R&1){H|=t.DATA_ALIGN;
}else{R=F.getHalfword(R);if(R<32768){J[E]=R;}else{J[E]=R|4294901760;}}break;case 35:R=J[G]+K;if(R&3){H|=t.DATA_ALIGN;}else{J[E]=F.getWord(R);}break;case 36:J[E]=F.getByte(J[E]+K);
break;case 37:R=J[G]+K;if(R&1){H|=t.DATA_ALIGN;}else{J[E]=F.getHalfword(R);}break;case 40:F.setByte(J[G]+K,J[E]&255);break;case 41:R=J[G]+K;if(R&1){H|=t.DATA_ALIGN;
}else{F.setHalfword(R,J[E]&65535);}break;case 43:R=J[G]+K;if(R&3){H|=t.DATA_ALIGN;}else{F.setWord(R,J[E]);}break;case 63:switch(D){case 0:this.eventBus.post("print","r"+G,"r",J[G]);
break;case 1:this.eventBus.post("print","0x"+f(J[G].toString(16),"0",8),"m",F.getByte(J[G]));break;case 2:R=J[G];var M="",S;while((S=F.getByte(R))!=0){M+=String.fromCharCode(S);
R++;}this.eventBus.post("print","0x"+f(J[G].toString(16),"0",8),"s",M);break;default:}break;default:H|=t.INVALID_INST;}if(this.branchTarget){this.pc=this.branchTarget;
this.branchTarget=c;return H;}if(L<0){L+=4294967296;}if(L&3){H|=t.PC_ALIGN;L+=4-(L&3);}if(C){if(this.branchTarget){H|=t.BRANCH_IN_DELAY_SLOT;}this.branchTarget=L;
}this.pc+=4;if(this.pc>4294967295){this.pc-=4294967296;}if(this.pc>A){this.pc=A;H|=PC_LIMIT;}return H;}var w={ADD:0,SUB:1,AND:2,OR:3,XOR:4,NOR:5,SLL:6,SRL:7,SRA:8,SLT:9,SLTU:10,NOP:11},p={NOP:0,RB:1,RHW:2,RW:3,WB:4,WHW:5,WW:6},n={N:0,LTZ:1,GTZ:2,LTEZ:3,GTEZ:4,EQ:5,NEQ:6};
q.ALU_OP=w;q.MEM_OP=p;q.BRANCH_COND=n;function v(){if(!this.if_id){this.if_id={};}i(this.if_id,{pc:0,inst:0});if(!this.id_ex){this.id_ex={};}i(this.id_ex,{aluOp:w.NOP,memOp:0,memLdSgn:false,memSrc:32,memVal:0,oprA:0,oprB:0,oprASrc:0,oprBSrc:33,ovEn:false,regDst:-1,regSrc:0,sa:0,rs:0,rt:0,rd:0,imm:0,pc:0,inst:0});
if(!this.ex_ma){this.ex_ma={};}i(this.ex_ma,{aluOut:0,memOp:0,memLdSgn:false,memSrc:32,memVal:0,regDst:-1,regSrc:0,pc:0,inst:0});if(!this.ma_wb){this.ma_wb={};
}i(this.ma_wb,{regVal:0,regDst:-1,pc:0,inst:0});this.retiredPC=0;this.retiredInst=0;if(!this.debugInfo){this.debugInfo={};}i(this.debugInfo,{stallFlag:0,bCond:-1,bCondAVal:0,bCondBVal:0,bCondASrc:0,bCondBSrc:0,bCondAFwd:c,bCondBFwd:c,bBaseSrc:0,bBaseFwd:c,bTarget:0,bTaken:false,memWSrc:c,memWVal:0,memWFwd:c,aluOp:w.NOP,aluA:0,aluB:0,aluASrc:0,aluBSrc:0,aluAFwd:c,aluBFwd:c,memVal:0,memOp:p.NOP,memAddr:0,regVal:0,regOp:false,regDst:-1,regSrc:0});
this.regStatus=[];for(var B=0;B<32;B++){this.regStatus[B]=0;}}function u(){this._initPipeline();this.cycle=0;this.stalls=0;this.pc=262144;this.branchTarget=c;
this.registerFile[28]=268468224;this.registerFile[29]=2147483644;}function o(){var T=this,W=T.mem,az=T.registerFile,aH=T.pc,aJ,aB,ao=new Uint32Array(2);
var aC=T.if_id,L=T.id_ex,C=T.ex_ma,Q=T.ma_wb,ax=T.debugInfo;var aD,ah,aK,al,ag,af,ak=C.memOp,ae=C.regDst,at=C.regSrc,E=C.aluOut,K=Q.regDst,G=Q.regVal;var B,an,aF,ap,am,ay,O,aw,ai,P=false,F=0,H=0,R=0,X=w.NOP,ad=0,ab=0,aA,V,aG=false,S=0,ac=-1,ar=false,aM=false;
var Y=false,aE=false,J,I,aL=0,N=0,M=0,av,aq,aa=0,Z=0,aI=false,aj=false;var U=0;ax.stallFlag=0;if(Q.regDst>=0){aD=(Q.regDst!=0)?Q.regVal:0;az[Q.regDst]=aD;
ax.regOp=true;ax.regDst=Q.regDst;ax.regVal=aD;}else{ax.regOp=false;}T.retiredPC=Q.pc;T.retiredInst=Q.inst;if(Q.regDst==C.memSrc){al=(Q.regDst==0)?0:Q.regVal;
}else{al=C.memVal;}switch(C.memOp){case 1:ah=W.getByte(C.aluOut);if(C.memLdSgn&&ah>127){ah|=4294967040;}break;case 2:ah=W.getHalfword(C.aluOut);if(C.memLdSgn&&ah>32767){ah|=4294901760;
}break;case 3:ah=W.getWord(C.aluOut);break;case 4:W.setByte(C.aluOut,al);break;case 5:W.setHalfword(C.aluOut,al);break;case 6:W.setWord(C.aluOut,al);break;
default:}if(C.regSrc){Q.regVal=ah;}else{Q.regVal=C.aluOut;}Q.regDst=C.regDst;Q.pc=C.pc;Q.inst=C.inst;ax.memVal=al;ax.memOp=C.memOp;ax.memSrc=C.memSrc;ax.memAddr=C.aluOut;
ax.regSrc=C.regSrc;if(L.oprASrc==C.regDst&&C.regSrc==0){ag=(C.regDst==0)?0:C.aluOut;ax.aluAFwd="EX_MA";}else{if(L.oprASrc==K){ag=aD;ax.aluAFwd="MA_WB";
}else{ag=L.oprA;ax.aluAFwd=c;}}if(L.oprBSrc==C.regDst&&C.regSrc==0){af=(C.regDst==0)?0:C.aluOut;ax.aluBFwd="EX_MA";}else{if(L.oprBSrc==K){af=aD;ax.aluBFwd="MA_WB";
}else{af=L.oprB;ax.aluBFwd=c;}}switch(L.aluOp){case w.ADD:aB=((ag&2147483648)?4294967296+ag:ag)+((af&2147483648)?4294967296+af:af);break;case w.SUB:aB=((ag&2147483648)?4294967296+ag:ag)-((af&2147483648)?4294967296+af:af);
break;case w.AND:aB=ag&af;break;case w.OR:aB=ag|af;break;case w.XOR:aB=ag^af;break;case w.NOR:aB=~(ag|af);break;case w.SLL:aB=ag<<(af&31);break;case w.SRL:aB=ag>>>(af&31);
break;case w.SRA:aB=ag>>(af&31);break;case w.SLT:aB=((ag|0)<(af|0));break;case w.SLTU:aB=(ag<af);break;case w.NOP:default:aB=ag;}if(L.ovEn&&(aB/2>>>31)^(aB>>>31)){U|=t.INT_OVERFLOW;
C.regDst=-1;}else{ao[0]=aB;C.aluOut=ao[0];C.regDst=L.regDst;}C.memVal=L.memVal;C.memLdSgn=L.memLdSgn;C.memSrc=L.memSrc;C.memOp=L.memOp;C.regSrc=L.regSrc;
C.pc=L.pc;C.inst=L.inst;ax.aluA=ag;ax.aluB=af;ax.aluASrc=L.oprASrc;ax.aluBSrc=L.oprBSrc;ax.aluOp=L.aluOp;az[0]=0;B=aC.inst,an=(B&4227858432)>>>26,aF=B&63,ap=(B&65011712)>>>21,am=(B&2031616)>>>16,ay=(B&63488)>>>11,ai=(B&1984)>>>6,O=B&65535,aw=(O&32768)?(O|4294901760):O;
switch(an){case 0:switch(aF){case 0:X=w.SLL;aA=am;V=33;ac=ay;O=ai;break;case 2:X=w.SRL;aA=am;V=33;ac=ay;O=ai;break;case 3:X=w.SRA;aA=am;V=33;ac=ay;O=ai;
break;case 4:X=w.SLL;aA=am;V=ap;ac=ay;aM=true;break;case 6:X=w.SRL;aA=am;V=ap;ac=ay;aM=true;break;case 7:X=w.SRA;aA=am;V=ap;ac=ay;aM=true;break;case 8:Y=true;
N=ap;break;case 13:U|=t.BREAK;break;case 32:X=w.ADD;aA=ap;V=am;ac=ay;aG=true;break;case 33:X=w.ADD;aA=ap;V=am;ac=ay;break;case 34:X=w.SUB;aA=ap;V=am;ac=ay;
aG=true;break;case 35:X=w.SUB;aA=ap;V=am;ac=ay;break;case 36:X=w.AND;aA=ap;V=am;ac=ay;break;case 37:X=w.OR;aA=ap;V=am;ac=ay;break;case 38:X=w.XOR;aA=ap;
V=am;ac=ay;break;case 39:X=w.NOR;aA=ap;V=am;ac=ay;break;case 42:X=w.SLT;aA=ap;V=am;ac=ay;break;case 43:X=w.SLTU;aA=ap;V=am;ac=ay;break;default:U|=INVALID_INST;
}break;case 1:switch(am){case 0:Y=true;aL=aw<<2;aa=ap;M=n.LT;break;case 1:Y=true;aL=aw<<2;aa=ap;M=n.GTE;break;default:U|=INVALID_INST;}break;case 2:Y=true;
O=(B&67108863)<<2;if(O<0){O=O+4294967296;}aL=O;N=33;break;case 4:Y=true;N=32;aL=aw<<2;M=n.EQ;aa=ap;Z=am;break;case 5:Y=true;N=32;aL=aw<<2;M=n.NEQ;aa=ap;
Z=am;break;case 6:Y=true;N=32;aL=aw<<2;M=n.LTEZ;aa=ap;Z=0;break;case 7:Y=true;N=32;aL=aw<<2;M=n.GTEZ;aa=ap;Z=0;break;case 8:X=w.ADD;aA=ap;V=33;ac=am;aG=true;
if(O&32768){O+=4294901760;}break;case 9:X=w.ADD;aA=ap;V=33;ac=am;if(O&32768){O+=4294901760;}break;case 10:X=w.SLT;aA=ap;V=33;ac=am;if(O&32768){O+=4294901760;
}break;case 11:X=w.SLTU;aA=ap;V=33;ac=am;if(O&32768){O+=4294901760;}break;case 12:X=w.AND;aA=ap;V=33;ac=am;break;case 13:X=w.OR;aA=ap;V=33;ac=am;break;
case 14:X=w.XOR;aA=ap;V=33;ac=am;break;case 15:X=w.ADD;aA=0;V=33;ac=am;O<<=16;break;case 32:X=w.ADD;aA=ap;V=33;if(O&32768){O+=4294901760;}ac=am;H=p.RB;
S=1;P=true;break;case 33:X=w.ADD;aA=ap;V=33;if(O&32768){O+=4294901760;}ac=am;H=p.RHW;S=1;P=true;break;case 35:X=w.ADD;aA=ap;V=33;if(O&32768){O+=4294901760;
}ac=am;H=p.RW;S=1;P=true;break;case 36:X=w.ADD;aA=ap;V=33;if(O&32768){O+=4294901760;}ac=am;H=p.RB;S=1;break;case 37:X=w.ADD;aA=ap;V=33;if(O&32768){O+=4294901760;
}ac=am;H=p.RHW;S=1;break;case 40:X=w.ADD;aA=ap;V=33;if(O&32768){O+=4294901760;}F=am;H=p.WB;break;case 41:X=w.ADD;aA=ap;V=33;if(O&32768){O+=4294901760;}F=am;
H=p.WHW;break;case 43:X=w.ADD;aA=ap;V=33;if(O&32768){O+=4294901760;}F=am;H=p.WW;break;case 63:switch(aF){case 0:this.eventBus.post("print","r"+ap,"r",az[ap]);
break;case 1:this.eventBus.post("print","0x"+f(az[ap].toString(16),"0",8),"m",W.getByte(az[ap]));break;case 2:aB=az[ap];var au="",D;while((D=W.getByte(aB))!=0){au+=String.fromCharCode(D);
aB++;}this.eventBus.post("print","0x"+f(az[ap].toString(16),"0",8),"s",au);break;default:}break;default:U|=t.INVALID_INST;}if(H>3){if(K==F){R=G;ax.memWFwd="MA_WB";
}else{if(ae==F&&at==0){R=(ae==0)?0:E;ax.memWFwd="EX_MA";}else{R=az[F];ax.memWFwd=c;}}ax.memWSrc=F;ax.memWVal=R;}else{ax.memWSrc=c;}if(Y){if(aa==K){av=G;
ax.bCondAFwd="MA_WB";}else{if(aa==ae&&at==0){av=(ae==0)?0:E;ax.bCondAFwd="EX_MA";}else{av=az[aa];ax.bCondAFwd=c;}}if(Z==K){aq=G;ax.bCondBFwd="MA_WB";}else{if(Z==ae&&at==0){aq=(ae==0)?0:E;
ax.bCondBFwd="EX_MA";}else{aq=az[Z];ax.bCondAFwd=c;}}if(N==K){I=G;ax.bBaseFwd="MA_WB";}else{if(I==ae&&at==0){I=(ae==0)?0:E;ax.bBaseFwd="EX_MA";}else{if(N<32){I=az[N];
}else{if(N==32){I=aC.pc;}else{I=aC.pc&4026531840;}}ax.bBaseFwd=c;}}}if(Y){switch(M){case n.LTZ:aE=(av&2147483648);break;case n.GTZ:aE=(av>0&&av<2147483648);
break;case n.LTEZ:aE=(av&2147483648)||(av==0);break;case n.GTEZ:aE=(av<2147483648);break;case n.EQ:aE=(av==aq);break;case n.NEQ:aE=(av!=aq);break;case n.N:default:aE=true;
}if(aE){J=aL+I;if(J&3){U|=PC_ALIGN;aE=false;}}}ax.bBaseSrc=N;ax.bCond=Y?M:-1;ax.bCondAVal=av;ax.bCondBVal=aq;ax.bCondASrc=aa;ax.bCondBSrc=Z;ax.bTarget=aL+I;
ax.bTaken=false;if(L.regDst!=0){if(L.memOp>0&&L.memOp<4){if(aA==L.regDst||V==L.regDst){aI=true;}}if(H>3&&F==L.regDst){aI=true;}if(Y){if(aa==L.regDst||Z==L.regDst||N==L.regDst){aE=false;
aI=true;}}}else{if(ak>0&&ak<4&&ae!=0){if(Y){if(aa==ae||Z==ae||N==ae){aE=false;aI=true;}}if(H>3&&F==ae){aI=true;}}}if(aI){ax.stallFlag|=s.ID;L.aluOp=w.NOP;
L.memOp=p.NOP;L.oprA=0;L.oprB=0;L.oprASrc=0;L.oprBSrc=0;L.regDst=-1;L.inst=0;}else{ad=az[aA];ab=(V==33)?O:az[V];ab=aM?ab&31:ab;L.aluOp=X;L.memOp=H;L.memLdSgn=P;
L.memSrc=F;L.memVal=R;L.oprA=ad;L.oprB=ab;L.oprASrc=aA;L.oprBSrc=V;L.ovEn=aG;L.regDst=ac;L.regSrc=S;L.sa=ab;L.rs=ap;L.rt=am;L.rd=ay;L.imm=O;L.pc=aC.pc;
L.inst=aC.inst;}if(W.busy){aC.inst=0;aI=true;ax.stallFlag|=s.IF;}else{if(!aI){aC.inst=W.getWord(T.pc);aC.pc=T.pc;}}if(aE){ao[1]=J;J=ao[1];T.pc=J;ax.bTaken=true;
}else{if(!aI){T.pc=T.pc+4;if(T.pc>4294967295){T.pc-=4294967296;}}else{T.stalls++;}}this.cycle++;return U;}q.Core=l;return q;})();e.CPU=a;var b=(function(){function w(ad){this.type=ad;
this.value=c;this.offset=c;}function n(){this._list=[];}d(n,{getLength:function(){return this._list.length;},getList:function(){return this._list;},get:function(ad){return this._list[ad];
},push:function(){Array.prototype.push.apply(this._list,arguments);},prepend:function(ad){this._list=ad.concat(this._list);},expect:function(ak,ad){var al;
if(ak instanceof Array){var ai=(this._list.length!=0),ah,ag,aj,ae,af=ak.length;if(af>this._list.length){return al;}for(ah=0;ah<af;ah++){aj=ak[ah];if(aj instanceof Array){ae=false;
for(ag=0;ag<aj.length;ag++){ae=ae||(this._list[ah].type==aj[ag]);}if(!ae){ai=false;break;}}else{if(this._list[ah].type!=aj){ai=false;break;}}}if(ai){if(ad){al=true;
}else{al=this._list.splice(0,af);}}}else{if(this._list[0]&&this._list[0].type==ak){if(ad){al=true;}else{al=this._list.splice(0,1)[0];}}}return al;},expectList:function(ae,af){var ad=[],ag=this.expect(ae);
if(ag){ad.push(ag.value);while((ag=this.expect([af,ae]))!=c){ad.push(ag[1].value);}return ad;}else{return c;}}});function S(af){var ad=af.split(/\n/);for(var ae=0,ag=ad.length;
ae<ag;ae++){ad[ae]=ad[ae].replace(/#.*$/,"").trim();}return ad;}var m=[{n:"SPECIAL",r:/^\.\w+/},{n:"LABEL",r:/^(\w+):/},{n:"STRING",r:/^"(([^\\"]|\\.)*)"/},{n:"COMMA",r:/^\s*,\s*/},{n:"SPACE",r:/^\s+/},{n:"REGOPR",r:/^(\$\w{1,2}|zero)/},{n:"COMOPR",r:/^(-*\d*)\((\$\w{1,2}|zero)\)/},{n:"INTEGER",r:/^(0x[\da-f]+|-*\d+|'([^'\\]|\\*)')/},{n:"WORD",r:/^(\w+)(?!:)/}],W=[],P={},H=[],y=0;
for(y=0;y<m.length;y++){W[y]=m[y].r;H[y]=m[y].n;P[m[y].n]=y;}function p(ae){var ai,ad,ah,aj=new n(),ag;while(ae.length>0){ad=false;for(var af=0;af<y;af++){ai=ae.match(W[af]);
if(ai&&ai[0]){ag=new w(af);switch(af){case P.STRING:ag.value=ai[1];break;case P.WORD:case P.LABEL:ag.value=ai[1].toLowerCase();break;case P.COMOPR:ag.offset=parseInt(ai[1]);
ag.value=ai[2].toLowerCase();break;case P.INTEGER:if(ai[2]){ag.value=ai[2].charCodeAt(0);}else{ag.value=parseInt(ai[0]);}break;default:ag.value=ai[0].toLowerCase();
}aj.push(ag);ae=ae.slice(ai.index+ai[0].length);ad=true;break;}}if(!ad){throw new Error("Unexpected syntax at: "+ae);}}return aj;}window.tokenize=p;var B=".space .byte .word .halfword .asciiz .ascii".split(" "),N={DATA:0,TEXT:1},A=4,l={},L=[],v=0,Q=a.INST_ALL,r=a.INST_REL_PC,o=a.INST_IMM_SHIFT,ab=a.INST_UNSIGNED;
for(var D in a.INST_CAT){L[v]=a.INST_CAT[D];l[D]=v;v++;}var ac=[{n:"la",e:[P.REGOPR,P.COMMA,P.WORD],t:"lui $r1,__h16__{2} ori {0},$r1,__l16__{2}"},{n:"li",e:[P.REGOPR,P.COMMA,P.INTEGER],t:"lui $r1,{2.H} ori {0},$r1,{2.L}"},{n:"pushr",e:[P.REGOPR],t:"sw {0},0($sp)addi $sp,$sp,-4"},{n:"popr",e:[P.REGOPR],t:"lw {0},4($sp)addi $sp,$sp,4"}],J,M=[],t=[],C=[];
for(J=0;J<ac.length;J++){M.push(ac[J].n);t.push(ac[J].e);C.push(ac[J].t);}var O=k(M,Q);function s(ad){return 4*(Math.floor((ad-0.1)/4)+1);}function G(ad){if(ad>2147483647){ad=2147483647;
}if(ad<-2147483648){ad=-2147483648;}return(ad<0)?4294967296+ad:ad;}function Y(ad){if(ad>32767){ad=32767;}if(ad<-32768){ad=-32768;}return(ad<0)?65536+ad:ad;
}function aa(ad){if(ad>127){ad=127;}if(ad<-128){ad=-128;}return(ad<0)?256+ad:ad;}function F(af){var ae,ag,ad=[];ag=af.length;for(ae=3;ae<ag;ae+=4){ad.push((af.charCodeAt(ae-3)*16777216)+(af.charCodeAt(ae-2)<<16)+(af.charCodeAt(ae-1)<<8)+(af.charCodeAt(ae)));
}ae=ag-ae+3;if(ae==0){ad.push(0);}else{if(ae==1){ad.push(af.charCodeAt(ag-1)*16777216);}else{if(ae==2){ad.push(af.charCodeAt(ag-2)*16777216+af.charCodeAt(ag-1)<<16);
}else{ad.push(af.charCodeAt(ag-3)*16777216+(af.charCodeAt(ag-2)<<16)+(af.charCodeAt(ag-1)<<8));}}}return ad;}window.packString=F;function x(ah,ae){var ad=[],ag,ai,af;
if(ae==4){ai=ah.length;for(ag=0;ag<ai;ag++){ad.push(G(ah[ag]));}}else{if(ae==2){ai=ah.length;if(ai%2!=0){ah.push(0);ai++;}for(ag=0;ag<ai;ag+=2){ad.push(Y(ah[ag])*65536+Y(ah[ag+1]));
}}else{if(ae==1){ai=ah.length;af=4-ai%4;if(af<4){for(ag=0;ag<af;ag++){ah.push(0);}ai+=af;}for(ag=0;ag<ai;ag+=4){ad.push(aa(ah[ag])*16777216+(aa(ah[ag+1])<<16)+(aa(ah[ag+2])<<8)+aa(ah[ag+3]));
}}else{throw new Error("Invaid unit size for alignment.");}}}return ad;}window.packIntegers=x;function I(ai,ag,ah,ae){var aj,ad,af,al,ak={type:N.DATA,addr:ah,line:ae};
if(ag==".space"){aj=ai.expect(P.INTEGER);if(aj){af=s(aj.value);ak.size=af;ak.data=c;}else{throw new Error("No size specified for .space.");}}else{if(ag==".asciiz"||ag==".ascii"){aj=ai.expect(P.STRING);
if(aj){al=F(aj.value);ak.size=al.length*4;ak.data=al;}else{throw new Error("No string specified for .asciiz");}}else{switch(ag){case".byte":ad=1;break;
case".halfword":ad=2;break;default:ad=4;}al=ai.expectList(P.INTEGER,P.COMMA);if(al){al=x(al,ad);ak.size=al.length*4;ak.data=al;}else{throw new Error("No data found after "+ag);
}}}return ak;}function Z(ad,ae){if(typeof(ad)=="string"){return true;}if(o.indexOf(ae)>=0){if(ad<0||ad>31){throw new Error("Shift amount "+ad+" out of range (0~31)");
return false;}}else{if(ab.indexOf(ae)>=0){if(ad<0||ad>65535){throw new Error("Unsigned integer "+ad+" out of range (0~65535)");return false;}}else{if(ad<-32768||ad>32767){throw new Error("Signed integer "+ad+" out of range (-32768~32767)");
return false;}}}return true;}function E(ak,ah,aj,ad){var al={type:N.TEXT,inst:ah,addr:aj,size:A,rs:c,rd:c,rt:c,imm:c,line:ad},af,ag,ai,ae;ai=-1;for(ae=0;
ae<v;ae++){if(L[ae].indexOf(ah)>=0){ai=ae;break;}}if(ai<0){throw new Error("Unknown instruction "+ah);}switch(ai){case l.RRR:af=ak.expect([P.REGOPR,P.COMMA,P.REGOPR,P.COMMA,P.REGOPR]);
if(af){al.rd=af[0].value;al.rs=af[2].value;al.rt=af[4].value;}else{throw new Error("Expecting 3 register operands for "+ah);}break;case l.RRI:af=ak.expect([P.REGOPR,P.COMMA,P.REGOPR,P.COMMA,[P.WORD,P.INTEGER]]);
if(af){al.rt=af[0].value;al.rs=af[2].value;ag=af[4].value;if(Z(ag,ah)){al.imm=ag;}}else{throw new Error("Expecting 2 register operands and 1 immediate for "+ah);
}break;case l.RRA:af=ak.expect([P.REGOPR,P.COMMA,P.REGOPR,P.COMMA,P.INTEGER]);if(af){al.rd=af[0].value;al.rt=af[2].value;ag=af[4].value;if(Z(ag,ah)){al.imm=ag;
}}else{throw new Error("Expecting 2 register operands and 1 immediate for "+ah);}break;case l.RC:af=ak.expect([P.REGOPR,P.COMMA,P.COMOPR]);if(af){al.rt=af[0].value;
al.rs=af[2].value;ag=af[2].offset;if(ag>=-32768&&ag<32768){al.imm=ag;}else{throw new Error("Offset value "+ag+" out of range (-32768~32767).");}}else{throw new Error("Expecting 1 register operand and 1 immediate for "+ah);
}break;case l.RI:af=ak.expect([P.REGOPR,P.COMMA,[P.WORD,P.INTEGER]]);if(af){al.rt=af[0].value;al.imm=af[2].value;}else{throw new Error("Expecting 1 register operand and 1 immediate for "+ah);
}break;case l.R:af=ak.expect([P.REGOPR,]);if(af){al.rs=af[0].value;}else{throw new Error("Expecting 1 register operand for "+ah);}break;case l.I:af=ak.expect([[P.WORD,P.INTEGER]]);
if(af){al.imm=af[0].value;}else{throw new Error("Expecting 1 immediate for "+ah);}break;case l.N:break;default:throw new Error("Unrecongnized instruction type "+ai);
}al.addr=aj;return al;}function T(ai,af){var ah=M[af],ag=t[af],ad=C[af],ae;ae=ai.expect(ag);if(ae){ad=ad.replace(/\{(\d+)\.*(.*?)\}/g,function(ak,am,al){var an=parseInt(am),aj;
if(isNaN(an)||an<0||an>=ae.length){throw new Error("Invalid index "+am+" in format string.");}if(al){if(al=="L"){aj=parseInt(ae[an].value)&65535;}else{if(al=="H"){aj=parseInt(ae[an].value)>>>16;
}else{aj=ae[an][al];}}if(aj==c){throw new Error("Attribute "+al+" is undefined.");}return String(aj);}else{return String(ae[an].value);}});return p(ad).getList();
}else{throw new Error("Syntax error near pseudo instruction "+ah);}return c;}function K(am,ai,ad,ap){var ar=0,ak,au,at,aq,al,ah,ag,ao,ae,af,an,av,aj=[];
while(am.getLength()>0){am.expect(P.SPACE);aq=false;ak=am.expect(P.LABEL);if(ak){am.expect(P.SPACE);if(ad[ak.value]){throw new Error('Symbol "'+ak.value+'" is redefined!');
}else{ad[ak.value]=(ap.section=="text")?ap.textCurrentAddr:ap.dataCurrentAddr;}aq=true;}ak=am.expect(P.SPECIAL);if(ak){am.expect(P.SPACE);if(ak.value==".data"){ap.section="data";
}else{if(ak.value==".text"){ap.section="text";}else{if(B.indexOf(ak.value)>=0){if(ap.section!="data"){throw new Error("Cannot allocate data in text section.");
}av=I(am,ak.value,ap.dataCurrentAddr,ai);ap.dataCurrentAddr+=av.size;ap.dataSize+=av.size;aj.push(av);}else{throw new Error("Unexpected syntax near "+ak.value);
}}}aq=true;}ak=am.expect(P.WORD);if(ak){if(ap.section!="text"){throw new Error("Instructions cannot be put into data section.");}am.expect(P.SPACE);aq=true;
ae=ak.value;at=false;if((an=M.indexOf(ae))>=0){if(O.indexOf(ae)>=0){if(am.expect(t[an],true)){am.prepend(T(am,an));at=true;}}else{am.prepend(T(am,an));
at=true;}}if(!at){av=E(am,ak.value,ap.textCurrentAddr,ai);ap.textCurrentAddr+=av.size;ap.textSize+=av.size;aj.push(av);}}if(!aq){throw new Error("Unexpected syntax near : "+am.get(0).value);
}}return aj;}var z=("zero $at $v0 $v1 $a0 $a1 $a2 $a3 $t0 $t1 $t2 $t3 $t4 $t5 $t6 $t7 $s0 $s1 $s2 $s3 $s4 $s5 $s6 $s7 $t8 $t9 $k0 $k1 $gp $sp $fp $ra").split(" ");
function U(af){var ad;if(af=="zero"){return 0;}else{if((ad=z.indexOf(af))>=0){return ad;}else{var ae=af.match(/\d+/),ag;if(ae){ag=parseInt(ae[0]);if(ag>=0&&ag<32){return ag;
}}}}throw new Error("Invalid register name "+af);}function V(ai,ad,af){var ag=ai.length,ah,al,ae,aj,ak;for(ah=0;ah<ag;ah++){al=ai[ah];if(al.type==N.DATA){continue;
}if(typeof(al.rt)=="string"){al.rt=U(al.rt);}if(typeof(al.rs)=="string"){al.rs=U(al.rs);}if(typeof(al.rd)=="string"){al.rd=U(al.rd);}if(typeof(al.imm)=="string"){if(al.imm.indexOf("__h16__")==0){aj=true;
ak=false;al.imm=al.imm.slice(7);}if(al.imm.indexOf("__l16__")==0){ak=true;aj=false;al.imm=al.imm.slice(7);}ae=ad[al.imm];if(ae==c){throw new Error("Undefined symbol "+al.imm);
}else{if(al.inst=="j"){ae=ae>>2;}else{if(r.indexOf(al.inst)>=0){ae=(ae-al.addr)>>2;if(ae<-32768||ae>32767){throw new Error('Target "'+al.imm+'" too far way.');
}}else{if(ak){ae=ae&65535;}if(aj){ae=ae>>>16;}}}al.imm=ae;}}}}function q(al,an,aj,ad){var ae=al.length,ak,ah,ag,am,ai,af;for(ak=0;ak<ae;ak++){am=al[ak];
if(am.type==N.DATA){if(am.data){ai=(am.addr-ad.dataStartAddr)>>2;af=ai+(am.size>>2);for(ah=ai,ag=0;ah<af;ah++,ag++){aj[ah]=am.data[ag];}}else{ai=(am.addr-ad.dataStartAddr)>>2;
af=ai+(am.size>>2);for(ah=ai;ah<af;ah++){aj[ah]=0;}}}else{ai=(am.addr-ad.textStartAddr)>>2;an[ai]=a.translators[am.inst](am);}}}function X(ag,ae){var ah=ag.length,af,ad=[];
for(af=0;af<ah;af++){cur=ag[af];if(cur.type==N.TEXT){ad[(cur.addr-ae.textStartAddr)>>2]=cur.line;}}return ad;}function R(ad,aj){var au=S(ad),an,ai=au.length,ag={},ah={section:"text",textSize:0,dataSize:0,dataStartAddr:0,dataCurrentAddr:0,textStartAddr:0,textCurrentAddr:0},ap={},at,aq=[];
aj=i({},aj);ah.dataStartAddr=(aj.dataStartAddr!=c)?aj.dataStartAddr:268435456;ah.textStartAddr=(aj.textStartAddr!=c)?aj.textStartAddr:262144;ah.dataCurrentAddr=ah.dataStartAddr;
ah.textCurrentAddr=ah.textStartAddr;for(an=0;an<ai;an++){try{at=p(au[an]);aq.push.apply(aq,K(at,an+1,ag,ah));}catch(al){throw new Error("L"+(an+1)+":"+al.message);
}}V(aq,ag,ah);var ar=ah.dataStartAddr,ak=ah.dataStartAddr+ah.dataSize,ao=ah.textStartAddr,af=ah.textStartAddr+ah.textSize;if(!(ak<ao||ar>af)){throw new Error("Overlap detected between data section and text section.");
}var am=[],ae=[];q(aq,ae,am,ah);return{dataStart:ah.dataStartAddr,textStart:ah.textStartAddr,dataSize:ah.dataSize,textSize:ah.textSize,dataMem:am,textMem:ae,sourceMap:X(aq,ah),symbolTable:ag};
}function u(aj){var ai=(aj&4227858432)>>>26,ae=aj&63,ag=(aj&65011712)>>>21,af=(aj&2031616)>>>16,am=(aj&63488)>>>11,al=(aj&1984)>>>6,ad=aj&65535,ah=(ad&32768)?(ad|4294901760):ad;
var ak;switch(ai){case 0:switch(ae){case 0:if(am==0&&af==0&&al==0){ak="nop (sll $r0, $r0, 0)";}else{ak="sll rd, rt, sa";}break;case 2:ak="srl rd, rt, sa";
break;case 3:ak="sra rd, rt, sa";break;case 4:ak="sllv rd, rt, rs";break;case 6:ak="srlv rd, rt, rs";break;case 7:ak="srav rd, rt, rs";break;case 8:ak="jr rs";
break;case 13:ak="break";break;case 32:ak="add rd, rs, rt";break;case 33:ak="addu rd, rs, rt";break;case 34:ak="sub rd, rs, rt";break;case 35:ak="subu rd, rs, rt";
break;case 36:ak="and rd, rs, rt";break;case 37:ak="or rd, rs, rt";break;case 38:ak="xor rd, rs, rt";break;case 39:ak="nor rd, rs, rt";break;case 42:ak="slt rd, rs, rt";
break;case 43:ak="sltu rd, rs, rt";break;default:ak="unknown";break;}break;case 1:switch(af){case 0:ak="bltz rs, offset";break;case 1:ak="bgez rs, offset";
break;default:ak="unknown";break;}break;case 2:ak="j addr";ad=aj&67108863;if(ad<0){ad=ad+4294967296;}break;case 4:ak="beq rs, rt, offset";break;case 5:ak="bne rs, rt, offset";
break;case 6:ak="blez rs, offset";break;case 7:ak="bgtz rs, offset";break;case 8:ak="addi rt, rs, imm";break;case 9:ak="addiu rt, rs, imm";break;case 10:ak="slti rt, rs, imm";
break;case 11:ak="sltiu rt, rs, imm";break;case 12:ak="andi rt, rs, imm";break;case 13:ak="ori rt, rs, imm";break;case 14:ak="xori rt, rs, imm";break;case 15:ak="lui rt, imm";
break;case 32:ak="lb rt, offset(rs)";break;case 33:ak="lh rt, offset(rs)";break;case 35:ak="lw";break;case 36:ak="lbu rt, offset(rs)";break;case 37:ak="lhu rt, offset(rs)";
break;case 40:ak="sb rt, offset(rs)";break;case 41:ak="sh rt, offset(rs)";break;case 43:ak="sw rt, offset(rs)";break;case 63:switch(ae){case 0:ak="print rs";
break;case 1:ak="printm rs";break;case 2:ak="prints rs";break;default:ak="unknown";break;}break;default:ak="unknown";break;}return ak.replace("rs","$r"+ag).replace("rt","$r"+af).replace("rd","$r"+am).replace("sa",al).replace("addr","0x"+ad.toString(16)).replace("offset","0x"+ad.toString(16)).replace("imm",ad);
}return{assemble:R,disassemble:u};})();e.Assembler=b;return e;})();